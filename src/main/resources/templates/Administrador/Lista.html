<!DOCTYPE html>
<html xmlns:th="http://thymeleafe.org">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script
	src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
	integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
	crossorigin="anonymous"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
	crossorigin="anonymous"></script>
<script src="/administrador.js"></script>
<script type="text/javascript">
	function fazPut(url, body) {
		console.log("body=", body)
		let request = new XMLHttpRequest()
		request.open("PUT", url, true)
		request.setRequestHeader("content-type", "application/json")
		request.send(JSON.stringify(body))

		return request.responseText
	}
	function updateUsuario() {

		let id = document.getElementById("idUsuario").value
		let nome = document.getElementById("nomeUsuario").value
		let nif = document.getElementById("nifUsuario").value
		let url = "http://localhost:8080/api/usuario/" + id

		console.log(id)
		console.log(nome)
		console.log(nif)

		body = {
			"id" : id,
			"nome" : nome,
			"nif" : nif
		}

		fazPut(url, body)

		location.reload()
	}
</script>

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
	integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"
	crossorigin="anonymous">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Document</title>
<style type="text/css">
td {
	font-family: Verdana, Geneva, Tahoma, sans-serif;
	padding: 5px;
}

th {
	background-color: black;
	color: white;
	padding: 12px;
	font-family: Verdana, Geneva, Tahoma, sans-serif;
}

.tabela {
	border: 3px solid blue;
	text-align: center;
	margin: auto;
	width: 80%;
}

a {
	text-decoration: none;
}

.nav {
	background: #202020;
	color: white;
}

.btn {
	float: right;
}
</style>
</head>

<!-- Button trigger modal -->
<button style="float: right;" type="button" class="btn btn-primary"
	data-toggle="modal" data-target="#modalCadastro">Cadastrar
	Usuario</button>

<!-- Modal -->
<div class="modal fade" id="modalCadastro" data-backdrop="static"
	data-keyboard="false" tabindex="-1"
	aria-labelledby="staticBackdropLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="staticBackdropLabel">Cadastrar
					Admin</h5>
				<button style="float: right;" type="button" class="close"
					data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<form method="post" action="/salvarAdmin">
					<div class="form-row">
						<div class="form-group col-md-6">
							<label for="inputEmail4">NOME</label> <input name="nome"
								required="required" placeholder="NOME" type="text"
								class="form-control" id="inputEmail4">
						</div>
						<div class="form-group col-md-6">
							<label for="inputPassword4">NIF</label> <input name="nif"
								required="required" placeholder="NIF" type="text"
								class="form-control" id="NIF" maxlength="7" minLength="7">
						</div>
					</div>
					<div class="form-group">
						<input name="senha" type="hidden" class="form-control"
							id="inputAddress" placeholder="SENHA">
					</div>

					<button type="submit" class="btn btn-primary">Cadastrar</button>
				</form>
			</div>

		</div>
	</div>
</div>

<!--FORMULARIO DE ALTERAÇÂO-->
<div class="modal fade" id="modalUpdateAdmin" data-backdrop="static"
	data-keyboard="false" tabindex="-1"
	aria-labelledby="staticBackdropLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="staticBackdropLabel">Atualizar
					Usuario</h5>
				<button style="float: right;" type="button" class="close"
					data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<form onsubmit="updateAdmin()">

					<input type="hidden" id="idAdm">

					<div class="form-row">
						<div class="form-group col-md-6">
							<label for="inputEmail4">NOME</label> <input name="nome"
								id="nomeAdm" placeholder="NOME" type="text" class="form-control">
						</div>
						<div class="form-group col-md-6">
							<label for="inputPassword4">NIF</label> <input name="nif"
								id="nifAdm" placeholder="NIF" type="text" maxlength="7"
								minLength="7" class="form-control">
						</div>
					</div>
					<div class="form-group">
						<label for="inputAddress">SENHA</label> <input name="senha"
							id="senhaAdm" type="password" class="form-control"
							placeholder="SENHA">
					</div>

					<button onsubmit="location.reload()" type="submit"
						class="btn btn-primary">Alterar</button>
				</form>
			</div>

		</div>
	</div>
</div>

<table border="1" class="tabela">
	<tr>
		<th>Id</th>
		<th>Nome</th>
		<th>Nif</th>

		<th>Alterar</th>
		<th>Excluir</th>


	</tr>


	<!-- each é uma "estrutura" de repetição -->
	<tr th:each="a: ${admin}">
		<td th:text="${a.id}"></td>
		<td th:text="${a.nome}"></td>
		<td th:text="${a.nif}"></td>

		<td><button th:onclick="atualizarAdmin([[${a.id}]])"
				id="btnALterarAdm">Alterar</button></td>
		<td><a th:href="@{/excluirAdmin(id=${a.id})}">Excluir</a></td>



	</tr>


</table>

<script type="text/javascript">
	function fazPut(url, body) {
		console.log("body=", body)
		let request = new XMLHttpRequest()
		request.open("PUT", url, true)
		request.setRequestHeader("content-type", "application/json")
		request.send(JSON.stringify(body))

		request.onload = function() {
			console.log(this.responseText)
		}

		return request.responseText
	}
	function updateAdmin() {

		let id = document.getElementById("idAdm").value
		let nome = document.getElementById("nomeAdm").value
		let nif = document.getElementById("nifAdm").value
		let senha = document.getElementById("senhaAdm").value
		let url = "http://localhost:8080/api/administrador/" + id

		console.log(id)
		console.log(nome)
		console.log(nif)

		body = {
			"id" : id,
			"nome" : nome,
			"nif" : nif,
			"senha" : senha
		}

		fazPut(url, body)
		location.reload();
	}
</script>




<body>
</html>